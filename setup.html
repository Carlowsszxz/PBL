<!DOCTYPE html>
<html lang="en" class="transition-colors duration-300">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="images/UMak_Logo_Registered.png">
    <title>Admin Dashboard - University of Makati</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles/login.css">
    <link rel="stylesheet" href="styles/setup.css">
    <link rel="stylesheet" href="styles/assign-modal.css">
    <style>
        [data-page="setup"] .bg-indigo-600 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .hover\:bg-indigo-700:hover {
            background-color: #121c54 !important
        }

        [data-page="setup"] .text-indigo-600 {
            color: #0e163e !important
        }

        [data-page="setup"] .hover\:text-indigo-700:hover {
            color: #121c54 !important
        }

        [data-page="setup"] .focus\:border-indigo-500:focus {
            border-color: #0e163e !important
        }

        [data-page="setup"] .focus\:ring-indigo-200:focus {
            box-shadow: 0 0 0 3px rgba(14, 22, 62, .2) !important
        }

        [data-page="setup"] .sidebar-nav-item.active {
            background: rgba(14, 22, 62, .15) !important;
            border-color: rgba(14, 22, 62, .4) !important;
            color: #0e163e !important
        }

        [data-page="setup"] .header-trigger-icon {
            color: #0e163e !important
        }

        [data-page="setup"] .bg-gradient-to-br {
            background: linear-gradient(135deg, #0e163e 0%, #121c54 100%) !important
        }

        [data-page="setup"] .bg-gradient-to-r {
            background: linear-gradient(90deg, #0e163e 0%, #121c54 100%) !important
        }

        [data-page="setup"] .from-indigo-600 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .to-pink-400 {
            background-color: #121c54 !important
        }

        [data-page="setup"] .from-green-500 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .to-indigo-500 {
            background-color: #121c54 !important
        }

        [data-page="setup"] .from-pink-600 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .to-indigo-400 {
            background-color: #121c54 !important
        }

        [data-page="setup"] .from-pink-500 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .to-indigo-800 {
            background-color: #121c54 !important
        }

        [data-page="setup"] .from-emerald-400 {
            background-color: #0e163e !important
        }

        [data-page="setup"] .from-pink-400 {
            background-color: #0e163e !important
        }

        .card-fadein {
            opacity: 0;
            animation: simplefadein 0.3s 0.1s ease-out forwards;
        }

        @keyframes simplefadein {
            to {
                opacity: 1;
            }
        }

        /* Scrollable container styles */
        #occupancyData,
        #noiseData {
            max-height: 500px;
            overflow-y: auto;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        #announcementsList {
            max-height: 600px;
            overflow-y: auto;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* Custom scrollbar styling */
        #occupancyData::-webkit-scrollbar,
        #noiseData::-webkit-scrollbar,
        #announcementsList::-webkit-scrollbar {
            width: 8px;
        }

        /* Noise Gauge Bar Styles */
        .noise-gauge-container {
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 12px;
            border: 1px solid #86efac;
        }

        .noise-gauge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .noise-db-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: #166534;
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .noise-db-unit {
            font-size: 1.2rem;
            color: #4b5563;
        }

        .noise-gauge-bar-wrapper {
            position: relative;
            width: 100%;
            height: 32px;
            background: #e5e7eb;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .noise-gauge-bar {
            height: 100%;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.5s ease;
            border-radius: 16px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .noise-gauge-bar-label {
            color: white;
            font-size: 0.875rem;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            white-space: nowrap;
        }

        .noise-gauge-bar.level-safe {
            background: linear-gradient(90deg, #10b981, #34d399);
        }

        .noise-gauge-bar.level-warning {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }

        .noise-gauge-bar.level-alert {
            background: linear-gradient(90deg, #ef4444, #f87171);
        }

        .noise-gauge-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.75rem;
            color: #6b7280;
        }

        .noise-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .noise-info-item {
            padding: 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }

        .noise-info-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .noise-info-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1f2937;
        }

        .noise-status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        /* Outline button style (no fill, only border) */
        .btn-outline {
            background: transparent;
            border: 1px solid #4f46e5; /* indigo-600 */
            color: #4f46e5;
            border-radius: 8px;
            transition: background-color .18s ease, color .18s ease, box-shadow .18s ease;
        }

        .btn-outline:hover {
            background: rgba(79,70,229,0.06);
            color: #3730a3; /* slightly darker on hover */
        }

        .noise-status-badge.safe {
            background: #d1fae5;
            color: #065f46;
        }

        .noise-status-badge.warning {
            background: #fed7aa;
            color: #92400e;
        }

        .noise-status-badge.alert {
            background: #fee2e2;
            color: #991b1b;
        }

        @media (max-width: 640px) {
            .noise-db-display {
                font-size: 2rem;
            }

            .noise-gauge-bar-wrapper {
                height: 28px;
            }

            .noise-info-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Quick Guide Button Styling */
        #quickGuideBtn {
            position: fixed !important;
            bottom: 24px !important;
            right: 24px !important;
            top: auto !important;
            z-index: 50 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            /* Removed backdrop-filter for performance */
            border: 2px solid #0e163e !important;
            width: 48px !important;
            height: 48px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 12px !important;
            box-shadow: 0 4px 16px rgba(14, 22, 62, 0.15) !important;
            transition: all 0.3s ease !important;
        }

        #quickGuideBtn:hover {
            background: #0e163e !important;
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 6px 24px rgba(14, 22, 62, 0.25) !important;
        }

        #quickGuideBtn:hover i {
            color: white !important;
        }

        #quickGuideBtn i {
            transition: color 0.3s ease !important;
            width: 24px !important;
            height: 24px !important;
        }

        #quickGuideBtn:active {
            transform: translateY(0) scale(1) !important;
        }

        [data-page="setup"] .quick-guide-trigger {
            all: unset !important;
            cursor: pointer !important;
        }

        /* Tooltip Popup Styles */
        #quickGuideTooltip {
            position: fixed !important;
            z-index: 100 !important;
            background: white !important;
            border-radius: 16px !important;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15), 0 8px 24px rgba(0, 0, 0, 0.1) !important;
            border: 1px solid rgba(14, 22, 62, 0.1) !important;
            max-width: 420px !important;
            width: 90vw !important;
            max-height: 85vh !important;
            overflow-y: auto !important;
            opacity: 0 !important;
            transform: scale(0.95) translateY(-10px) !important;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
            pointer-events: none !important;
        }

        #quickGuideTooltip.show {
            opacity: 1 !important;
            transform: scale(1) translateY(0) !important;
            pointer-events: all !important;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            #quickGuideTooltip {
                max-width: calc(100vw - 32px) !important;
                width: calc(100vw - 32px) !important;
                max-height: 90vh !important;
                border-radius: 20px !important;
                left: 16px !important;
                right: 16px !important;
                margin: 0 auto !important;
            }

            #quickGuideTooltip .p-6 {
                padding: 1.25rem !important;
            }

            .guide-item {
                padding: 0.875rem !important;
                gap: 0.75rem !important;
                min-height: 60px !important;
            }

            .guide-item h3 {
                font-size: 0.875rem !important;
            }

            .guide-item p {
                font-size: 0.75rem !important;
                line-height: 1.4 !important;
            }

            .guide-item i[data-lucide] {
                min-width: 16px !important;
            }

            #guideDetailView .space-y-4>div {
                padding: 0.875rem !important;
            }

            #guideDetailView h2 {
                font-size: 1.125rem !important;
            }

            #guideDetailView h3 {
                font-size: 0.8125rem !important;
            }

            #guideDetailView p {
                font-size: 0.75rem !important;
                line-height: 1.5 !important;
            }

            #guideDetailView .flex.items-center.gap-3 {
                gap: 0.75rem !important;
            }

            #closeTooltipBtn,
            #closeTooltipBtnDetail {
                min-height: 44px !important;
                min-width: 44px !important;
                padding: 0.75rem !important;
            }

            #backToListBtn {
                min-height: 44px !important;
                padding: 0.625rem 1rem !important;
                font-size: 0.875rem !important;
            }

            #backToListBtn span {
                font-size: 0.875rem !important;
            }
        }

        #quickGuideTooltip::-webkit-scrollbar {
            width: 8px;
        }

        #quickGuideTooltip::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        #quickGuideTooltip::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        #quickGuideTooltip::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .tooltip-arrow {
            position: absolute !important;
            width: 12px !important;
            height: 12px !important;
            background: white !important;
            border: 1px solid rgba(14, 22, 62, 0.1) !important;
            border-top: none !important;
            border-left: none !important;
            transform: rotate(45deg) !important;
        }

        .guide-item {
            position: relative !important;
            -webkit-tap-highlight-color: transparent !important;
            touch-action: manipulation !important;
        }

        .guide-item:hover {
            transform: none !important;
        }

        @media (max-width: 768px) {
            .guide-item:active {
                transform: scale(0.98) !important;
                background-color: rgba(14, 22, 62, 0.05) !important;
            }

            .guide-item:hover {
                transform: none !important;
            }
        }

        #guideDetailView {
            animation: fadeIn 0.2s ease-in !important;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(10px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Responsive positioning */
        @media (max-width: 1024px) {
            #quickGuideBtn {
                bottom: 20px !important;
                right: 20px !important;
            }

            #quickGuideTooltip {
                max-width: 380px !important;
            }
        }

        @media (max-width: 768px) {
            #quickGuideBtn {
                bottom: 16px !important;
                right: 16px !important;
                width: 44px !important;
                height: 44px !important;
            }

            #quickGuideBtn i {
                width: 22px !important;
                height: 22px !important;
            }
        }

        /* Force burger menu to be visible and clickable on mobile */
        @media (max-width: 768px) {
            #burgerMenuBtn {
                display: flex !important;
                position: fixed !important;
                top: 1rem !important;
                right: 1rem !important;
                width: 48px !important;
                height: 48px !important;
                min-width: 48px !important;
                min-height: 48px !important;
                z-index: 999999 !important;
                pointer-events: auto !important;
                background: rgba(255, 255, 255, 1) !important;
                border: 2px solid rgba(14, 22, 62, 0.2) !important;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
                cursor: pointer !important;
                touch-action: manipulation !important;
                -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
            }

            #burgerMenuBtn .burger-line {
                pointer-events: none !important;
            }
        }

        @media (min-width: 769px) {
            #burgerMenuBtn {
                display: none !important;
            }
        }
    </style>
</head>

<body
    class="text-slate-900 min-h-screen flex flex-col relative setup-body-bg"
    data-page="setup">
    <!-- Visual Effects -->
    <div id="cursor-follower" class="cursor-follower" aria-hidden="true"></div>
    <div id="library-background" class="library-background" aria-hidden="true"></div>
    <div id="paper-background" class="paper-background" aria-hidden="true"></div>

    <style>
        [data-page="setup"] .nav-label {
            left: 250px;
            right: auto;
            top: 25px;
            z-index: 99999;
            /* keep other styles (padding, font, bg, etc.) as is */
        }
    </style>

    <!-- Old navigation hidden for setup page - styles in setup.css -->

    <!-- Old mobile menu system removed - using new sidebar toggle instead -->

    <!-- Modern Layout: Fixed Sidebar + Main Content -->
    <div class="admin-layout-container">
        <!-- Fixed Sidebar (Left) -->
        <aside id="adminSidebar" class="admin-sidebar">
            <div class="sidebar-header">
                <img src="images/UMak_Logo_Registered.png" alt="University of Makati Logo" class="sidebar-logo" />
                <h1 class="sidebar-title">Admin Dashboard</h1>
            </div>
            <nav class="sidebar-nav">
                <a href="setup.html" class="admin-nav-link active" data-label="Admin Dashboard"
                    aria-label="Admin Dashboard">
                    <i data-lucide="settings" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Dashboard</span>
                </a>
                <a href="user-management.html" class="admin-nav-link" data-label="User Management"
                    aria-label="User Management">
                    <i data-lucide="users" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Users</span>
                </a>
                <a href="rfid-management.html" class="admin-nav-link" data-label="RFID Management"
                    aria-label="RFID Management">
                    <i data-lucide="contact" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Devices</span>
                </a>
                <a href="student-reports.html" class="admin-nav-link" data-label="Student Reports"
                    aria-label="Student Reports">
                    <i data-lucide="book-open-check" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Reports</span>
                </a>
                <a href="activity-logs.html" class="admin-nav-link" data-label="Activity Logs"
                    aria-label="Activity Logs">
                    <i data-lucide="list" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Activity</span>
                </a>
                <a href="lcd-messages.html" class="admin-nav-link" data-label="LCD Messages" aria-label="LCD Messages">
                    <i data-lucide="tv" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">LCD Messages</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="#" onclick="logout(); return false;" class="admin-nav-link logout-item" data-label="Logout"
                    aria-label="Logout">
                    <i data-lucide="log-out" class="admin-nav-icon"></i>
                    <span class="admin-nav-text">Logout</span>
                </a>
            </div>
        </aside>

        <!-- Main Content Area (Right) -->
        <main class="admin-main-content">
            <!-- Top Navigation Bar -->
            <header class="admin-top-nav">
                <div class="top-nav-left">
                    <button id="sidebarToggle" class="sidebar-toggle-btn" aria-label="Toggle sidebar"
                        aria-expanded="false" aria-controls="adminSidebar">
                        <i data-lucide="menu" class="w-5 h-5"></i>
                    </button>
                    <h1 class="page-title">Admin Dashboard</h1>
                </div>
                <div class="top-nav-right">
                    <div class="top-nav-profile">
                        <div class="profile-avatar">A</div>
                    </div>
                </div>
            </header>

            <!-- Quick Guide Button (Fixed Position) -->
            <button id="quickGuideBtn" class="quick-guide-trigger" aria-label="Toggle Quick Guide"
                title="Show Admin Guide">
                <i data-lucide="help-circle"
                    class="text-gray-400 hover:text-indigo-600 transition-colors cursor-pointer"></i>
                <span id="guideBadge" class="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full hidden"></span>
            </button>

            <!-- Tooltip Popup -->
            <div id="quickGuideTooltip" class="hidden">
                <div class="tooltip-arrow"></div>
                <div class="p-6">
                    <!-- Main Guide List View -->
                    <div id="guideListView">
                        <div class="flex items-center justify-between mb-5">
                            <h2 class="text-xl font-bold setup-title-color">Admin Navigation Guide</h2>
                            <button id="closeTooltipBtn" class="text-gray-400 hover:text-gray-600 transition-colors p-1"
                                aria-label="Close guide">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        </div>
                        <div class="space-y-3">
                            <div class="guide-item flex items-start gap-3 p-3 bg-indigo-50/50 rounded-lg border border-indigo-100 hover:bg-indigo-50 transition-colors cursor-pointer"
                                data-guide="dashboard">
                                <div class="setup-icon-bg rounded-lg p-2 flex-shrink-0">
                                    <i data-lucide="settings" class="setup-icon-color w-5 h-5"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold setup-title-color mb-1 text-sm">Admin
                                        Dashboard</h3>
                                    <p class="text-xs text-gray-600">View system statistics, manage
                                        announcements,
                                        monitor occupancy and noise levels.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400 mt-1"></i>
                            </div>

                            <div class="guide-item flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors cursor-pointer"
                                data-guide="users">
                                <div class="bg-gray-200 rounded-lg p-2 flex-shrink-0">
                                    <i data-lucide="users" class="text-gray-700 w-5 h-5"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900 mb-1 text-sm">User
                                        Management</h3>
                                    <p class="text-xs text-gray-600">Add new users, update
                                        information, change roles,
                                        and manage accounts.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400 mt-1"></i>
                            </div>

                            <div class="guide-item flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors cursor-pointer"
                                data-guide="devices">
                                <div class="bg-gray-200 rounded-lg p-2 flex-shrink-0">
                                    <i data-lucide="contact" class="text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">Device
                                        Management</h3>
                                    <p class="text-xs text-gray-600">Assign and manage access
                                        devices, view status, and
                                        track usage.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400"></i>
                            </div>

                            <div class="guide-item flex items-start gap-3 p-3 bg-gray-50"
                                data-guide="reports">
                                <div class="bg-gray-200">
                                    <i data-lucide="book-open-check"
                                        class="text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">Student
                                        Reports</h3>
                                    <p class="text-xs text-gray-600">View submitted reports, filter
                                        by status, and
                                        manage responses.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400"></i>
                            </div>

                            <div class="guide-item flex items-start gap-3 p-3 bg-gray-50"
                                data-guide="logs">
                                <div class="bg-gray-200">
                                    <i data-lucide="list" class="text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">Activity
                                        Logs</h3>
                                    <p class="text-xs text-gray-600">Monitor system activity
                                        including logins, logouts,
                                        and interactions.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400"></i>
                            </div>

                            <div class="guide-item flex items-start gap-3 p-3 bg-gray-50"
                                data-guide="lcd">
                                <div class="bg-gray-200">
                                    <i data-lucide="tv" class="text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">LCD Messages
                                    </h3>
                                    <p class="text-xs text-gray-600">Configure display messages shown
                                        on physical LCD
                                        screens.</p>
                                </div>
                                <i data-lucide="chevron-right"
                                    class="w-4 h-4 text-gray-400"></i>
                            </div>
                        </div>
                        <div class="mt-5 p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <p class="text-xs text-blue-900">
                                <i data-lucide="info" class="w-3 h-3 inline mr-1.5"></i>
                                <strong>Tip:</strong> Click navigation icons in the sidebar. Use refresh buttons for
                                real-time updates.
                            </p>
                        </div>
                    </div>

                    <!-- Detail View (Hidden by default) -->
                    <div id="guideDetailView" class="hidden">
                        <div class="flex items-center justify-between mb-5">
                            <button id="backToListBtn"
                                class="flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-100"
                                aria-label="Back to list">
                                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                                <span>Back</span>
                            </button>
                            <button id="closeTooltipBtnDetail"
                                class="text-gray-400"
                                aria-label="Close guide">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        </div>
                        <div id="guideDetailContent"></div>
                    </div>
                </div>
            </div>
            <!-- Content Area with CSS Grid -->
            <div id="adminGrid"
                class="admin-content-grid gap-6 p-4 sm:p-6 bg-[#f8f9fa]" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); grid-auto-rows: min-content;">
                <!-- Controls Bar -->
                <div
                    class="col-span-full sticky top-0 z-10 -mx-4 sm:-mx-6 px-4 sm:px-6 py-3 bg-[#f8f9fa]/90">
                    <div class="flex items-center gap-2 text-sm font-medium text-gray-700">
                        <i data-lucide="layout-grid" class="w-4 h-4"></i>
                        <span>Admin Dashboard</span>
                    </div>
                </div>
                <!-- Stats Card -->
                <section
                    class="card-fadein dash-card rounded-2xl shadow-sm hover:shadow-md transition-all p-4 sm:p-6 border border-gray-200" style="grid-column: span 1; min-width: 320px;">
                    <div class="admin-card-header flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2">
                            <i data-lucide="bar-chart-3" class="w-5 h-5 text-indigo-600"></i>
                            <h2 class="text-lg font-semibold setup-title-color">System Overview</h2>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Total Users Stat -->
                        <div class="group relative overflow-hidden rounded-xl p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-blue-200">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-blue-600">Total Users</p>
                                    <p class="text-3xl font-bold text-blue-900" id="totalUsers">-</p>
                                </div>
                                <div class="w-12 h-12 rounded-lg bg-blue-500/10">
                                    <i data-lucide="users" class="w-6 h-6 text-blue-600"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Access Devices Stat -->
                        <div class="group relative overflow-hidden rounded-xl p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-purple-200">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-purple-600">Access Devices</p>
                                    <p class="text-3xl font-bold text-purple-900" id="totalRfid">-</p>
                                </div>
                                <div class="w-12 h-12 rounded-lg bg-purple-500/10">
                                    <i data-lucide="credit-card" class="w-6 h-6 text-purple-600"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Occupied Seats Stat -->
                        <div class="group relative overflow-hidden rounded-xl p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-green-200">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-green-600">Occupied Seats</p>
                                    <p class="text-3xl font-bold text-green-900" id="occupiedSeats">-</p>
                                </div>
                                <div class="w-12 h-12 rounded-lg bg-green-500/10">
                                    <i data-lucide="armchair" class="w-6 h-6 text-green-600"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Pending Reports Stat -->
                        <div class="group relative overflow-hidden rounded-xl p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-orange-200">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-orange-600">Pending Reports</p>
                                    <p class="text-3xl font-bold text-orange-900" id="pendingReports">-</p>
                                </div>
                                <div class="w-12 h-12 rounded-lg bg-orange-500/10">
                                    <i data-lucide="alert-circle" class="w-6 h-6 text-orange-600"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Table Occupancy Pie Chart -->
                <section
                    class="admin-card card-fadein dash-card bg-white/90" style="grid-column: span 1; min-width: 320px;">
                    <div class="admin-card-header flex items-center gap-2">
                        <i data-lucide="pie-chart" class="w-4 h-4 text-gray-500"></i>
                        <h2 class="text-lg font-semibold setup-title-color">Current Table Occupancy Overview</h2>
                    </div>
                    <p class="text-xs text-gray-600">Real-time occupancy visualization across
                        all tables</p>
                    <div class="flex flex-col items-center justify-center py-6">
                        <div class="w-full max-w-md relative">
                            <canvas id="occupancyPieChart"></canvas>
                            <div id="totalOccupancyLabel"
                                class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none">
                                <div class="text-3xl font-bold text-gray-900"
                                    id="totalOccupancyPercent">0%</div>
                                <div class="text-xs text-gray-500">Total Occupancy</div>
                            </div>
                        </div>
                        <div id="chartLegend" class="mt-6 w-full max-w-md"></div>
                    </div>
                </section>

                <!-- Noise Card -->
                <section class="admin-card card-fadein dash-card bg-white/90" style="grid-column: 1 / -1;">
                    <div class="admin-card-header mb-6 flex items-center gap-2">
                        <i data-lucide="volume-2" class="w-5 h-5 text-indigo-500"></i>
                        <h2 class="text-lg font-semibold setup-title-color">Noise Monitor</h2>
                    </div>

                    <!-- Table Selector -->
                    <div class="mb-6">
                        <label for="noiseTableSelect" class="block text-sm font-medium text-gray-700">Select Table</label>
                        <select id="noiseTableSelect" onchange="viewNoiseLevel()"
                            class="w-full max-w-xs px-3 py-2 border border-gray-300">
                            <option value="table-1">Table 1</option>
                            <option value="table-2" disabled>Table 2 (Future Expansion)</option>
                            <option value="table-3" disabled>Table 3 (Future Expansion)</option>
                            <option value="table-4" disabled>Table 4 (Future Expansion)</option>
                        </select>
                    </div>

                    <!-- Noise Gauge -->
                    <div id="noiseData" class="mb-8"></div>

                    <!-- Live Noise Alerts -->
                    <div class="mb-8">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-base font-semibold text-gray-900">
                                <i data-lucide="alert-triangle" class="w-4 h-4 text-amber-500"></i>
                                Live Noise Alerts
                            </h3>
                            <div id="noiseAlertsStatus" class="text-xs text-gray-500"></div>
                        </div>
                        <div id="noiseAlertsList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                        <div id="noiseNoAlerts" class="text-sm text-gray-500">
                            <i data-lucide="check-circle" class="w-8 h-8 mx-auto mb-2 text-green-500"></i>
                            No active alerts. All tables are within the threshold.
                        </div>
                    </div>

                    <!-- Noise Alert History -->
                    <div>
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-base font-semibold text-gray-900">
                                <i data-lucide="clock" class="w-4 h-4 text-blue-500"></i>
                                Noise Alert History
                            </h3>
                            <button id="refreshNoiseHistoryBtn"
                                class="px-4 py-2 text-sm rounded-lg bg-gray-100">
                                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                Refresh
                            </button>
                        </div>
                        <div id="noiseAlertHistory" class="space-y-3"></div>
                    </div>
                </section>

                <!-- Occupancy Card -->
                <section class="admin-card card-fadein dash-card bg-white/90" style="grid-column: 1 / -1;">
                    <div class="admin-card-header mb-6 flex items-center gap-2">
                        <i data-lucide="users" class="w-5 h-5 text-emerald-500"></i>
                        <h2 class="text-lg font-semibold setup-title-color">Seat Occupancy</h2>
                    </div>

                    <!-- Table Selector -->
                    <div class="mb-6">
                        <label for="occupancyTableSelect" class="block text-sm font-medium text-gray-700">Select Table</label>
                        <select id="occupancyTableSelect" onchange="viewOccupancy()"
                            class="w-full max-w-xs px-3 py-2 border border-gray-300">
                            <option value="all-tables">Show All Tables</option>
                            <option value="table-1">Table 1</option>
                            <option value="table-2">Table 2</option>
                            <option value="table-3" disabled>Table 3 (Future Expansion)</option>
                            <option value="table-4" disabled>Table 4 (Future Expansion)</option>
                        </select>
                    </div>

                    <!-- Filter Chips -->
                    <div class="flex flex-wrap gap-3 mb-6">
                        <button class="filter-chip active" data-filter="all" onclick="filterSeats('all')">
                            <i data-lucide="clipboard-list" class="w-4 h-4"></i>
                            <span>All Seats</span>
                        </button>
                        <button class="filter-chip" data-filter="student" onclick="filterSeats('student')">
                            <i data-lucide="user" class="w-4 h-4"></i>
                            <span>Students</span>
                        </button>
                        <button class="filter-chip" data-filter="admin" onclick="filterSeats('admin')">
                            <i data-lucide="settings" class="w-4 h-4"></i>
                            <span>Admin Use</span>
                        </button>
                        <button class="filter-chip" data-filter="available" onclick="filterSeats('available')">
                            <i data-lucide="check-circle" class="w-4 h-4"></i>
                            <span>Available</span>
                        </button>
                    </div>

                    <!-- Occupancy Data -->
                    <div id="occupancyData" class="mb-8"></div>

                    <!-- Recent Assignments Section -->
                    <div id="recentAssignments" class="recent-assignments hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-base font-semibold text-gray-900">
                                <i data-lucide="clock" class="w-4 h-4 text-blue-500"></i>
                                Recent Assignments
                            </h3>
                            <button onclick="clearRecentAssignments()" class="px-4 py-2 text-sm rounded-lg bg-gray-100">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                                Clear
                            </button>
                        </div>
                        <div id="recentAssignmentsList" class="space-y-3"></div>
                    </div>
                </section>

                <!-- Statistics Report -->
                <section
                    class="admin-card card-fadein dash-card bg-white/90" style="grid-column: 1 / -1; min-width: 320px;">
                    <div class="admin-card-header flex items-center gap-2">
                        <i data-lucide="bar-chart-3" class="w-5 h-5 text-blue-500"></i>
                        <h2 class="text-lg font-semibold setup-title-color mb-1">Analytics Dashboard</h2>
                    </div>
                    <p class="text-xs text-gray-600">Monitor usage patterns, identify peak times, and track system performance</p>

                    <!-- Key Metrics Summary -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="p-4 rounded-lg border border-blue-200">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="users" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm font-medium text-blue-900">Total Logins</span>
                            </div>
                            <div class="text-2xl font-bold text-blue-900" id="totalLoginsMetric">--</div>
                            <div class="text-xs text-blue-700">This period</div>
                        </div>

                        <div class="p-4 rounded-lg border border-green-200">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-600"></i>
                                <span class="text-sm font-medium text-green-900">Peak Hour</span>
                            </div>
                            <div class="text-2xl font-bold text-green-900" id="peakHourMetric">--:--</div>
                            <div class="text-xs text-green-700">Most active time</div>
                        </div>

                        <div class="p-4 rounded-lg border border-purple-200">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="alert-triangle" class="w-4 h-4 text-purple-600"></i>
                                <span class="text-sm font-medium text-purple-900">Reports</span>
                            </div>
                            <div class="text-2xl font-bold text-purple-900" id="totalReportsMetric">--</div>
                            <div class="text-xs text-purple-700">Student issues</div>
                        </div>

                        <div class="p-4 rounded-lg border border-orange-200">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="activity" class="w-4 h-4 text-orange-600"></i>
                                <span class="text-sm font-medium text-orange-900">Avg. Session</span>
                            </div>
                            <div class="text-2xl font-bold text-orange-900" id="avgSessionMetric">--m</div>
                            <div class="text-xs text-orange-700">Time per user</div>
                        </div>
                    </div>

                    <!-- Filters and Actions -->
                    <div class="bg-gray-50">
                        <div class="flex flex-col lg:flex-row lg:items-end gap-4 flex-wrap">
                            <div class="flex-1 min-w-[200px]">
                                <label for="statsStartDate" class="block text-sm font-medium text-gray-700">
                                    üìÖ Date Range
                                </label>
                                <div class="flex gap-2">
                                    <div>
                                        <label for="statsStartDate" class="block text-xs text-gray-500">From</label>
                                        <input id="statsStartDate" type="date" class="form-input w-full" />
                                    </div>
                                    <div>
                                        <label for="statsEndDate" class="block text-xs text-gray-500">To</label>
                                        <input id="statsEndDate" type="date" class="form-input w-full" />
                                    </div>
                                </div>
                            </div>

                            <div class="flex-1 min-w-[180px]">
                                <label for="statsTableFilter" class="block text-sm font-medium text-gray-700">
                                    üè¢ Filter by Table
                                </label>
                                <select id="statsTableFilter" class="form-input w-full">
                                    <option value="all">üìä All Tables</option>
                                    <option value="table-1">üè∑Ô∏è Table 1</option>
                                    <option value="table-2">üè∑Ô∏è Table 2</option>
                                    <option value="table-3" disabled>üöß Table 3 (Future)</option>
                                    <option value="table-4" disabled>üöß Table 4 (Future)</option>
                                </select>
                            </div>

                            <div class="flex gap-2 flex-wrap">
                                <button id="statsRefreshBtn" class="btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                    Refresh Data
                                </button>
                                <button id="statsExportCsvBtn" class="btn bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <i data-lucide="download" class="w-4 h-4"></i>
                                    Export CSV
                                </button>
                                <button id="statsPrintBtn" class="btn bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <i data-lucide="printer" class="w-4 h-4"></i>
                                    Print Report
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-200">
                            <div class="text-sm text-gray-600">
                                üí° <strong>Tip:</strong> Use date filters to analyze specific time periods, or export data for detailed analysis
                            </div>
                            <div class="text-xs text-gray-500 flex items-center gap-2" id="statsLastUpdated">
                                <i data-lucide="clock" class="w-3 h-3"></i>
                                Updated: --
                            </div>
                        </div>
                    </div>

                    <!-- Charts Grid -->
                    <div id="statisticsReport" class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6">
                        <div class="bg-white">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="text-sm font-semibold setup-title-color flex items-center gap-2">
                                    <i data-lucide="table" class="w-4 h-4 text-emerald-500"></i>
                                    Table Popularity
                                </h3>
                                <span class="text-xs bg-emerald-100">By Login Count</span>
                            </div>
                            <div class="text-xs text-gray-600">
                                Shows which tables are most frequently used by students
                            </div>
                            <canvas id="topTablesChart" height="250"></canvas>
                        </div>

                        <div class="bg-white">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="text-sm font-semibold setup-title-color flex items-center gap-2">
                                    <i data-lucide="clock" class="w-4 h-4 text-blue-500"></i>
                                    Usage Patterns
                                </h3>
                                <span class="text-xs bg-blue-100">Hourly Activity</span>
                            </div>
                            <div class="text-xs text-gray-600">
                                Identifies peak hours and low-traffic periods for better resource planning
                            </div>
                            <canvas id="peakHoursChart" height="250"></canvas>
                        </div>

                        <div class="bg-white">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="text-sm font-semibold setup-title-color flex items-center gap-2">
                                    <i data-lucide="alert-circle" class="w-4 h-4 text-red-500"></i>
                                    Issue Tracker
                                </h3>
                                <span class="text-xs bg-red-100">Problem Types</span>
                            </div>
                            <div class="text-xs text-gray-600">
                                Common problems reported by students - helps prioritize fixes
                            </div>
                            <canvas id="problemsChart" height="250"></canvas>
                        </div>
                    </div>

                    <!-- Actionable Insights -->
                    <div class="p-4 rounded-lg border border-indigo-200">
                        <div class="flex items-center gap-2 mb-3">
                            <i data-lucide="lightbulb" class="w-5 h-5 text-yellow-500"></i>
                            <h4 class="text-sm font-semibold setup-title-color">Key Insights & Recommendations</h4>
                        </div>

                        <div id="statsInsights" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="flex items-start gap-3 p-3 bg-white">
                                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"></div>
                                <div>
                                    <div class="text-sm font-medium text-gray-900">No activity detected</div>
                                    <div class="text-xs text-gray-600">Check date filters or system connectivity</div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 pt-3 border-t border-indigo-200">
                            <div class="flex items-center gap-2 text-xs text-gray-600">
                                <i data-lucide="info" class="w-3 h-3"></i>
                                <span><strong>üí° Pro Tips:</strong> Monitor peak hours to schedule maintenance, review common issues weekly, and use export feature for detailed trend analysis</span>
                            </div>
                        </div>
                    </div>
                </section>
                </section>

                <!-- Announcements Card -->
                <section
                    class="admin-card card-fadein dash-card bg-white/90" style="grid-column: 1 / -1; min-width: 320px;">
                    <div class="admin-card-header flex items-center gap-2">
                        <i data-lucide="megaphone" class="w-4 h-4 text-gray-500"></i>
                        <h2 class="text-lg font-semibold setup-title-color">Manage Announcements</h2>
                    </div>
                    <p class="text-xs text-gray-600">Create and manage announcements visible to
                        all users</p>

                    <!-- Create New Announcement Form -->
                    <div
                        class="mt-6 p-6 bg-gray-50">
                        <h3 class="text-base font-bold text-gray-900">
                            <i data-lucide="plus-circle" class="w-5 h-5 text-indigo-600"></i>
                            Create New Announcement
                        </h3>
                        <form id="announcementForm" class="space-y-5">
                            <div>
                                <label for="announcementTitle"
                                    class="block text-sm font-semibold text-gray-700">Title</label>
                                <input type="text" id="announcementTitle" required maxlength="100"
                                    placeholder="Enter announcement title..."
                                    class="w-full px-4 py-3 bg-white"
                                    aria-describedby="title-hint">
                            </div>
                            <div>
                                <label for="announcementMessage"
                                    class="block text-sm font-semibold text-gray-700">Message</label>
                                <textarea id="announcementMessage" required rows="4" maxlength="500"
                                    placeholder="Enter announcement message..."
                                    class="w-full px-4 py-3 bg-white"
                                    aria-describedby="char-count-hint"></textarea>
                                <div id="char-count-hint" class="text-xs text-gray-500">
                                    <span id="charCount">0</span> / 500 characters
                                </div>
                            </div>
                            <div class="flex flex-wrap gap-4 py-2">
                                <label class="flex items-center gap-2 cursor-pointer group">
                                    <input type="checkbox" id="announcementPriority"
                                        class="w-4 h-4 rounded border-gray-300">
                                    <span
                                        class="text-sm font-medium text-gray-700">Priority
                                        (highlighted)</span>
                                </label>
                            </div>
                            <div>
                                <label for="announcementExpires"
                                    class="block text-sm font-semibold text-gray-700">Expires At
                                    (Optional)</label>
                                <input type="datetime-local" id="announcementExpires"
                                    class="w-full px-4 py-3 bg-white"
                                    aria-describedby="expires-hint">
                                <div id="expires-hint" class="sr-only">Leave empty for announcement to never
                                    expire</div>
                            </div>
                            <div class="flex gap-3 pt-2">
                                <button type="submit"
                                    class="flex items-center gap-2 px-6 py-3 btn-outline"
                                    aria-label="Post new announcement">
                                    <i data-lucide="send" class="w-4 h-4"></i>
                                    Post Announcement
                                </button>
                                <button type="button" onclick="clearAnnouncementForm()"
                                    class="flex items-center gap-2 px-6 py-3 bg-white"
                                    aria-label="Clear form">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                    Clear
                                </button>
                            </div>
                            <div id="announcementResult" class="text-sm mt-2"></div>
                        </form>
                    </div>

                    <!-- Existing Announcements List -->
                    <div class="mt-8">
                        <div class="flex items-center justify-between mb-5">
                            <h3 class="text-base font-bold text-gray-900">
                                <i data-lucide="list" class="w-5 h-5 text-indigo-600"></i>
                                Existing Announcements
                            </h3>
                        </div>
                        <div id="announcementsList" class="space-y-3">
                            <p class="text-gray-600">Loading
                                announcements...</p>
                        </div>
                    </div>
                </section>

                <!-- Reports Overview Card -->
                <section
                    class="admin-card card-fadein dash-card bg-white/90" style="grid-column: 1 / -1; min-width: 320px;">
                    <div class="admin-card-header flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <i data-lucide="clipboard-list" class="w-4 h-4 text-gray-500"></i>
                            <h2 class="text-lg font-semibold setup-title-color">Reports Overview</h2>
                            <span id="reportsTotal"
                                class="ml-2 px-2 py-0.5 bg-purple-100">0</span>
                        </div>
                        <div class="text-xs text-gray-500" id="reportsLastUpdated">Loading...</div>
                    </div>
                    <p class="text-xs text-gray-600">Student report submissions by category and
                        time period</p>

                    <!-- Filter Controls -->
                    <div class="flex flex-wrap gap-2 mt-4 mb-6">
                        <button type="button" onclick="filterReportsOverview('today')" class="reports-filter-btn active"
                            data-filter="today">
                            <i data-lucide="calendar-days" class="w-3 h-3"></i>
                            Today
                        </button>
                        <button type="button" onclick="filterReportsOverview('week')" class="reports-filter-btn"
                            data-filter="week">
                            <i data-lucide="calendar-range" class="w-3 h-3"></i>
                            This Week
                        </button>
                        <button type="button" onclick="filterReportsOverview('all')" class="reports-filter-btn"
                            data-filter="all">
                            <i data-lucide="calendar" class="w-3 h-3"></i>
                            All Time
                        </button>
                        <button type="button" onclick="refreshReportsOverview()" class="reports-filter-btn ml-auto"
                            data-filter="refresh">
                            <i data-lucide="refresh-cw" class="w-3 h-3"></i>
                            Refresh
                        </button>
                    </div>

                    <!-- Chart Container -->
                    <div class="p-4 border rounded-lg bg-white">
                        <canvas id="reportsChart" class="max-h-72"></canvas>
                    </div>

                    <!-- Category Breakdown -->
                    <div id="reportsCategoryBreakdown"
                        class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 mt-6">
                        <div
                            class="text-center p-4 rounded-xl bg-white">
                            <h3 class="text-sm font-semibold text-gray-800">Issues</h3>
                            <p id="issueCount" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                        <div
                            class="text-center p-4 rounded-xl bg-white">
                            <h3 class="text-sm font-semibold text-gray-800">Feedback</h3>
                            <p id="feedbackCount" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                        <div
                            class="text-center p-4 rounded-xl bg-white">
                            <h3 class="text-sm font-semibold text-gray-800">Complaints</h3>
                            <p id="complaintCount" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                        <div
                            class="text-center p-4 rounded-xl bg-white">
                            <h3 class="text-sm font-semibold text-gray-800">Suggestions</h3>
                            <p id="suggestionCount" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                        <div
                            class="text-center p-4 rounded-xl bg-white">
                            <h3 class="text-sm font-semibold text-gray-800">Other</h3>
                            <p id="otherCount" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </section>
            </div><!-- End of admin-content-grid -->
        </main>
    </div>

     <!-- Student Assignment Modal -->
     <div id="assignModal" class="assign-modal-overlay" style="display:none;" onclick="if(event.target === this) { closeAssignModal(); }">
        <div class="assign-modal">
            <div class="assign-modal-header">
                <h3 id="assignModalTitle">Assign Seat</h3>
                <button class="assign-modal-close" onclick="closeAssignModal()" aria-label="Close modal">
                    √ó
                </button>
            </div>
            <div class="assign-modal-body">
                <!-- Assignment Mode Selector -->
                <div class="assign-mode-selector">
                    <div class="assign-mode-btn active" data-mode="student" onclick="selectAssignMode('student')">
                        <div class="assign-mode-icon">üë§</div>
                        <div class="assign-mode-label">Assign Student</div>
                    </div>
                    <div class="assign-mode-btn" data-mode="admin" onclick="selectAssignMode('admin')">
                        <div class="assign-mode-icon">üîß</div>
                        <div class="assign-mode-label">Admin Use</div>
                    </div>
                </div>

                <!-- Student Search Section (visible only in student mode) -->
                <div id="studentSearchSection" class="student-search-container" style="display: block;">
                    <div class="search-input-wrapper">
                        <input type="text" id="studentSearchInput" class="student-search-input" placeholder="Search by name or student ID..." oninput="searchStudents(this.value)" autocomplete="off">
                    </div>
                    <div id="searchResults" class="search-results" style="display: none;"></div>
                </div>

                <!-- Admin Assignment Notice (visible only in admin mode) -->
                <div id="adminAssignSection" class="admin-assign-notice" style="display: none;">
                    <strong>‚ö†Ô∏è Admin Use Mode</strong>
                    <p style="margin-top: 8px;">This seat will be marked as occupied for administrative purposes
                        (testing, maintenance, or temporary use).</p>
                </div>

                <!-- Selected Student Display -->
                <div id="selectedStudentDisplay" style="display: none; padding: 16px; background: #f0f4ff; border-radius: 12px; border: 2px solid #667eea; margin-bottom: 16px;">
                    <div style="font-weight: 600; color: #000000; margin-bottom: 8px;">Selected Student:</div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="selectedStudentAvatar" class="search-result-avatar"></div>
                        <div>
                            <div id="selectedStudentName" style="font-weight: 600; color: #000000;"></div>
                            <div id="selectedStudentDetails" style="font-size: 0.875rem; color: #000000;"></div>
                        </div>
                    </div>
                    <button onclick="clearSelectedStudent()" style="margin-top: 12px; padding: 6px 12px; background: white; border: 1px solid #e5e7eb; border-radius: 6px; cursor: pointer; font-size: 0.875rem; color: #000000;">
                        Change Student
                    </button>
                </div>

                <!-- Loading State -->
                <div id="assignLoading" class="assign-loading" style="display: none;">
                    <div class="assign-spinner"></div>
                    <div>Processing assignment...</div>
                </div>
            </div>
            <div class="assign-modal-footer">
                <button class="assign-btn assign-btn-cancel" onclick="closeAssignModal()">Cancel</button>
                <button id="confirmAssignBtn" class="assign-btn assign-btn-confirm" onclick="confirmAssignment()" disabled>
                    Assign Seat
                </button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="scripts/login-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="scripts/setup.js"></script>
    <script>
        // ============================================
        // ============================================
        document.addEventListener('DOMContentLoaded', function () {
            const html = document.documentElement;

            // Check for saved theme preference or default to light mode
            const currentTheme = localStorage.getItem('theme') || 'light';

            // Wait for Lucide to load, then initialize icons
            let lucideRetries = 0;
            const MAX_RETRIES = 50; // 50 * 100ms = 5 seconds max wait

            function initializeLucideIcons() {
                if (typeof lucide !== 'undefined' && typeof lucide.createIcons === 'function') {
                    lucide.createIcons();
                    console.log('‚úì Lucide icons initialized (attempt ' + (lucideRetries + 1) + ')');
                } else {
                    lucideRetries++;
                    if (lucideRetries < MAX_RETRIES) {
                        // Lucide not loaded yet, wait 100ms and try again
                        console.log('‚è≥ Waiting for Lucide to load... (attempt ' + lucideRetries + ')');
                        setTimeout(initializeLucideIcons, 100);
                    } else {
                        console.error('‚úó Lucide failed to load after ' + MAX_RETRIES + ' attempts');
                    }
                }
            }
            initializeLucideIcons();

            // Function to update Chart.js charts when theme changes
            function updateChartsTheme(initial = false) {
                const isDark = html.classList.contains('dark');
                const textColor = isDark ? '#e5e7eb' : '#374151';
                const gridColor = isDark ? 'rgba(75, 85, 99, 0.3)' : 'rgba(156, 163, 175, 0.2)';

                if (typeof Chart !== 'undefined' && Chart.instances) {
                    Object.values(Chart.instances).forEach(chart => {
                        if (chart && chart.options) {
                            // Update text colors
                            if (chart.options.plugins && chart.options.plugins.title) {
                                chart.options.plugins.title.color = textColor;
                            }

                            if (chart.options.scales) {
                                Object.keys(chart.options.scales).forEach(scaleKey => {
                                    const scale = chart.options.scales[scaleKey];
                                    if (scale.ticks) scale.ticks.color = textColor;
                                    if (scale.grid) scale.grid.color = gridColor;
                                });
                            }

                            if (chart.options.plugins && chart.options.plugins.legend) {
                                chart.options.plugins.legend.labels = {
                                    ...chart.options.plugins.legend.labels,
                                    color: textColor
                                };
                            }

                            chart.update();
                        }
                    });
                }
            }

            // Apply initial theme to charts
            setTimeout(() => updateChartsTheme(true), 500);
        });
    </script>
    <script>
    function blockIfMobileOrTablet() {
        // Simple mobile/tablet detection (checks for touch and screen size)
        function isMobileOrTablet() {
            // Check for touch support and screen width
            const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const isSmallScreen = window.innerWidth <= 1024;
            // User agent fallback for some tablets/phones
            const ua = navigator.userAgent.toLowerCase();
            const isMobileUA = /android|iphone|ipad|ipod|blackberry|windows phone|opera mini|mobile|tablet/.test(ua);
            return (hasTouch && isSmallScreen) || isMobileUA || isSmallScreen;
        }

        if (isMobileOrTablet()) {
            // Replace the entire body with the block message
            document.body.innerHTML = `
                <div style="
                    min-height:100vh;
                    display:flex;
                    flex-direction:column;
                    justify-content:center;
                    align-items:center;
                    background:linear-gradient(135deg,#f8fafc 0%,#e0e7ef 100%);
                    color:#222;
                    font-family:Inter,sans-serif;
                    text-align:center;
                    padding:2rem;
                ">
                    <div style="
                        background:#fff;
                        border-radius:1.25rem;
                        box-shadow:0 4px 24px rgba(0,0,0,0.07);
                        padding:2.5rem 1.5rem;
                        max-width:400px;
                        width:100%;
                    ">
                        <svg width="48" height="48" fill="none" viewBox="0 0 24 24" style="margin-bottom:1.5rem;display:block;margin-left:auto;margin-right:auto;">
                            <rect width="24" height="24" rx="12" fill="#f3f4f6"/>
                            <path d="M8 17h8M9 7h6a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2Z" stroke="#64748b" stroke-width="1.5"/>
                            <path d="M12 15v2" stroke="#64748b" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <h1 style="font-size:1.25rem;font-weight:600;margin-bottom:0.75rem;">This page is only accessible on a PC.</h1>
                        <p style="font-size:1rem;color:#64748b;">Please open this on a computer.</p>
                    </div>
                </div>
            `;
            // Prevent scrolling/back navigation
            document.body.style.overflow = 'hidden';
        }
    }
    document.addEventListener('DOMContentLoaded', blockIfMobileOrTablet);
    window.addEventListener('resize', blockIfMobileOrTablet);
    </script>
</body>

</html>
