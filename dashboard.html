<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="images/UMak_Logo_Registered.png">
    <title>Dashboard - University of Makati</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="styles/login.css">
    <link rel="stylesheet" href="styles/dashboard.css">
</head>

<body class="text-slate-900 min-h-screen flex flex-col relative" data-page="dashboard">
    <div id="cursor-follower" class="cursor-follower" aria-hidden="true"></div>
    <div id="library-background" class="library-background lazy-bg" aria-hidden="true" data-bg="images/Wallpaper.jpg"></div>
    <div id="paper-background" class="paper-background" aria-hidden="true"></div>

    <!-- Header Trigger Button (Peek Arrow) -->
    <button id="headerTrigger" class="header-trigger" aria-label="Toggle header navigation">
        <svg class="header-trigger-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </button>

    <!-- Hover Label -->
    <div id="navLabel" class="nav-label"></div>

    <!-- Modern Top Navigation Bar (Collapsible) -->
    <nav id="headerNav" class="modern-sidebar header-collapsed">
        <!-- Brand/Logo -->
        <div class="sidebar-brand">
            <img src="images/UMak_Logo_Registered.png" alt="University of Makati Logo" />
        </div>

        <!-- Navigation Items -->
        <a href="dashboard.html" class="sidebar-nav-item active" data-label="Dashboard" aria-label="Dashboard">
            <i data-lucide="layout-dashboard" class="sidebar-icon"></i>
        </a>

        <a href="map.html" class="sidebar-nav-item" data-label="Seat Map" aria-label="Seat Map">
            <i data-lucide="map" class="sidebar-icon"></i>
        </a>

        <a href="reports.html" class="sidebar-nav-item" data-label="Reports" aria-label="Reports">
            <i data-lucide="file-text" class="sidebar-icon"></i>
        </a>

        <a href="#" onclick="logout(); return false;" class="sidebar-nav-item" data-label="Logout" aria-label="Logout">
            <i data-lucide="log-out" class="sidebar-icon"></i>
        </a>
    </nav>

    <!-- Burger Menu Button (Mobile Only) -->
    <button class="burger-menu-btn" id="burgerMenuBtn" aria-label="Toggle menu">
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
    </button>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

    <!-- Mobile Menu Panel -->
    <div class="mobile-menu-panel" id="mobileMenuPanel">
        <div class="mobile-menu-header">
            <img src="images/UMak_Logo_Registered.png" alt="UMak Logo" />
            <div class="mobile-menu-title">Student Portal</div>
        </div>

        <a href="dashboard.html" class="mobile-nav-item active">
            <i data-lucide="layout-dashboard" class="mobile-nav-icon"></i>
            <span>Dashboard</span>
        </a>

        <a href="map.html" class="mobile-nav-item">
            <i data-lucide="map" class="mobile-nav-icon"></i>
            <span>Seat Map</span>
        </a>

        <a href="reports.html" class="mobile-nav-item">
            <i data-lucide="file-text" class="mobile-nav-icon"></i>
            <span>Reports</span>
        </a>

        <a href="#" onclick="logout(); return false;" class="mobile-nav-item">
            <i data-lucide="log-out" class="mobile-nav-icon"></i>
            <span>Logout</span>
        </a>
    </div>

    <main class="main-with-sidebar flex-1 w-full px-4 sm:px-6 lg:px-8 py-12">
        <div class="fade-content max-w-6xl mx-auto">
            <div class="bg-white/85 backdrop-blur-md rounded-2xl shadow-lg p-8 border border-white/30 mb-8">
                <div class="flex items-start justify-between gap-4 flex-wrap">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-900">
                            Welcome, <span id="userName" class="text-indigo-600"></span>
                        </h2>
                        <p id="welcomeSub" class="text-gray-600 mt-2 text-sm">Loading...</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="flex items-center gap-2 text-sm text-gray-600">
                            <i data-lucide="clock" class="w-4 h-4"></i>
                            <span id="nowTime">—</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Correction Request Alert (Full Width) -->
            <div id="correctionAlert" class="bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-xl shadow-lg mb-8 overflow-hidden hidden">
                <!-- Header with icon and close button -->
                <div class="bg-orange-500 text-white px-4 sm:px-6 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                                <i data-lucide="alert-triangle" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold">Action Required</h3>
                                <p class="text-orange-100 text-sm">Account correction needed</p>
                            </div>
                        </div>
                        <button onclick="closeCorrectionAlert()" 
                            class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors"
                            aria-label="Close alert">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-4 sm:p-6">
                    <!-- Description -->
                    <div class="mb-6">
                        <p class="text-gray-700 text-sm sm:text-base leading-relaxed">
                            An administrator has identified issues with your account information that need to be corrected. 
                            Please review the details below and update your information promptly.
                        </p>
                    </div>

                    <!-- Correction Details Card -->
                    <div class="bg-white border border-orange-200 rounded-lg p-4 mb-6 shadow-sm">
                        <div class="flex items-start gap-3 mb-3">
                            <div class="w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                <i data-lucide="file-text" class="w-3 h-3 text-orange-600"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900 mb-2">What needs to be corrected:</h4>
                                <div id="correctionDetails" class="text-sm text-gray-700 whitespace-pre-line leading-relaxed">
                                    <!-- Correction reason will be inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Deadline Notice -->
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                        <div class="flex items-center gap-3">
                            <div class="w-6 h-6 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <i data-lucide="clock" class="w-3 h-3 text-red-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm text-red-800">
                                    <span class="font-semibold">Correction Deadline:</span>
                                    <span id="correctionDeadline" class="ml-2 font-mono">—</span>
                                </p>
                                <p class="text-xs text-red-600 mt-1">
                                    Your account access may be limited until corrections are completed.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-3">
                        <button onclick="openCorrectionModal()" 
                            class="flex-1 inline-flex items-center justify-center px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-xl transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2">
                            <i data-lucide="edit-3" class="w-5 h-5 mr-2"></i>
                            <span>Update My Information</span>
                        </button>
                        <button onclick="contactAdmin()" 
                            class="sm:flex-initial inline-flex items-center justify-center px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-xl transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                            <i data-lucide="help-circle" class="w-5 h-5 mr-2"></i>
                            <span class="hidden sm:inline">Need Help?</span>
                            <span class="sm:hidden">Help</span>
                        </button>
                    </div>

                    <!-- Help Text -->
                    <div class="mt-4 pt-4 border-t border-orange-200">
                        <div class="flex items-start gap-2">
                            <i data-lucide="info" class="w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"></i>
                            <p class="text-xs text-gray-600 leading-relaxed">
                                <strong>Need assistance?</strong> Click "Need Help?" to contact an administrator, 
                                or use "Update My Information" to make the requested changes yourself.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column -->
                <div class="space-y-6">
                    <div id="rfidAssignment" class="p-6 bg-indigo-50 rounded-xl border border-indigo-100 hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-semibold text-gray-900">Register Your Access Device</h3>
                            <span class="text-sm text-indigo-600 font-medium">Required for Library Access</span>
                        </div>

                        <div class="bg-white rounded-lg p-4 mb-6 border border-indigo-100">
                            <p class="font-medium text-gray-700 mb-2">How to Register:</p>
                            <ol class="list-decimal list-inside space-y-2 text-gray-600">
                                <li class="flex items-start">
                                    <span class="mr-2">1.</span>
                                    <span>Visit the library and tap your access device on any reader</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">2.</span>
                                    <span>Note the Device ID that appears on the reader's display (it's
                                        case-sensitive)</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">3.</span>
                                    <span>Enter that exact ID below (copy-paste if possible to avoid errors)</span>
                                </li>
                            </ol>
                        </div>

                        <form id="assignRfidForm" class="space-y-4">
                            <div>
                                <label for="rfidInput" class="block text-sm font-medium text-gray-700 mb-2">
                                    Device ID:
                                    <span class="text-gray-500 font-normal ml-1">(8-20 characters, letters A-F and
                                        numbers only)</span>
                                </label>
                                <input type="text" id="rfidInput" placeholder="Example: A1B2C3D4"
                                    pattern="^[A-F0-9]{8,20}$" required
                                    class="w-full p-3 rounded-lg border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition font-mono">
                                <p class="mt-1 text-xs text-gray-500">Make sure to enter the ID exactly as shown on the
                                    reader</p>
                            </div>
                            <div class="flex items-center space-x-4">
                                <button type="submit"
                                    class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition flex items-center">
                                    <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 8V16M8 12H16" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" />
                                    </svg>
                                    Register Device
                                </button>
                                <div id="rfidError" class="text-red-600 text-sm"></div>
                            </div>
                        </form>
                    </div>

                    <div id="myStatus" class="p-6 bg-white/85 backdrop-blur-md rounded-xl border border-white/30">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-xl font-semibold text-gray-900">Your Status</h3>
                            <span id="sessionPill"
                                class="text-xs px-3 py-1 rounded-full bg-gray-200 text-gray-700">—</span>
                        </div>
                        <p id="statusText" class="text-gray-700">Loading...</p>
                    </div>

                    <div id="mySeat" class="p-6 bg-white/85 backdrop-blur-md rounded-xl border border-white/30">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-xl font-semibold text-gray-900">Your Seat</h3>
                            <button id="locateOnMapBtn"
                                class="inline-flex items-center gap-2 text-sm px-3 py-2 rounded-lg bg-indigo-100 text-indigo-700 hover:bg-indigo-200">
                                <i data-lucide="map" class="w-4 h-4"></i>
                                Locate on Map
                            </button>
                        </div>
                        <p id="seatInfo" class="text-gray-700">Loading...</p>
                    </div>

                    <div id="myNoise"
                        class="p-6 bg-gradient-to-br from-green-50 to-teal-50 rounded-xl border border-green-100">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-xl font-semibold text-gray-900">Current Noise Level</h3>
                            <span id="noiseUpdated" class="text-[10px] sm:text-xs text-gray-600">—</span>
                        </div>
                        <div class="flex items-center gap-3 mb-4">
                            <div id="noiseEmoji" class="text-2xl">—</div>
                            <div class="flex-1">
                                <div class="text-gray-800 mb-1">
                                    <span id="noiseDb" class="font-semibold text-2xl">—</span>
                                    <span class="text-sm">dB</span>
                                    <span id="noiseComfort" class="ml-2 text-sm font-medium">—</span>
                                </div>
                                <!-- Visual Progress Bar Gauge -->
                                <div class="w-full h-3 bg-gray-200 rounded-full overflow-hidden mt-2">
                                    <div id="noiseGauge" class="h-full transition-all duration-500 rounded-full"
                                        style="width: 0%;"></div>
                                </div>
                                <!-- Gauge Labels -->
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0</span>
                                    <span>40</span>
                                    <span>55</span>
                                    <span>70</span>
                                    <span>100</span>
                                </div>
                            </div>
                        </div>
                        <p id="noiseTip" class="mt-2 text-xs text-gray-600">—</p>
                    </div>

                    <div class="p-6 bg-white/85 backdrop-blur-md rounded-xl border border-white/30">
                        <h3 class="text-xl font-semibold text-gray-900 mb-3">Quick Actions</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                            <a href="reports.html"
                                class="quick-action-btn inline-flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm"
                                data-color="indigo">
                                <i data-lucide="file-plus" class="w-4 h-4"></i>
                                Report Issue
                            </a>
                            <a href="map.html"
                                class="quick-action-btn inline-flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm"
                                data-color="slate">
                                <i data-lucide="map" class="w-4 h-4"></i>
                                Seat Map
                            </a>
                            <a href="reports.html"
                                class="quick-action-btn inline-flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm"
                                data-color="emerald">
                                <i data-lucide="list" class="w-4 h-4"></i>
                                My Reports
                            </a>
                            <a href="#" onclick="logout(); return false;"
                                class="quick-action-btn inline-flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm"
                                data-color="rose">
                                <i data-lucide="log-out" class="w-4 h-4"></i>
                                Logout
                            </a>
                        </div>
                    </div>


                </div>

                <!-- Right Column -->
                <div class="space-y-6">
                    <!-- ========================================== -->
                    <!-- ANNOUNCEMENTS - Modern Card Design -->
                    <!-- ========================================== -->
                    <div class="group bg-white rounded-2xl border border-white/50 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden">
                        <!-- Header with Icon & Timestamp -->
                        <div class="bg-gradient-to-r from-indigo-500/10 to-purple-500/10 px-5 py-4 border-b border-indigo-100/50">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    
                                    <div>
                                        <h3 class="text-lg font-bold text-gray-900">Announcements</h3>
                                        <p class="text-xs text-gray-500">Latest updates</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Announcements List with Modern Cards -->
                        <div class="p-5">
                            <div id="announcements" class="space-y-3 announcements-scrollable max-h-[320px] overflow-y-auto pr-2 bg-white/10 rounded-lg border border-indigo-200/30 p-4">
                                <!-- Empty State (will be replaced by JS) -->
                                <div class="flex flex-col justify-center py-8 text-center">
                                    <p class="text-gray-500 text-sm font-medium">No announcements yet</p>
                                    <p class="text-gray-400 text-xs mt-1">Check back later for updates</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ========================================== -->
                    <!-- TODAY'S ACTIVITY - Timeline with Icons -->
                    <!-- ========================================== -->
                    <div class="group bg-white rounded-2xl border border-white/50 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden">
                        <!-- Header -->
                        <div class="px-5 py-4 border-b border-green-100/50">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                 
                                    <div>
                                        <h3 class="text-lg font-bold text-gray-900">Today's Activity</h3>
                                        <p class="text-xs text-gray-500">Your session history</p>
                                    </div>
                                </div>
                                <a href="reports.html" class="flex items-center gap-1.5 text-sm text-green-700 hover:text-green-800 font-medium hover:gap-2 transition-all group/link">
                                    <span>View all</span>
                                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                </a>
                            </div>
                        </div>
                        
                        <!-- Timeline Content -->
                        <div class="p-5">
                            <div id="activityTimeline" class="space-y-4 activity-timeline-scrollable max-h-[320px] overflow-y-auto pr-2">
                                <!-- Static Info State -->
                                <div class="flex flex-col items-center justify-center py-8 text-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-3">
                                        <i data-lucide="calendar-x" class="w-8 h-8 text-gray-400"></i>
                                    </div>
                                    <p class="text-gray-500 text-sm font-medium">Loading too long?</p>
                                    <p class="text-gray-400 text-xs mt-1">It means you have no activity records yet.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ========================================== -->
                    <!-- YOUR STATS - Engaging Visual Cards -->
                    <!-- ========================================== -->
                    <div class="group bg-white rounded-2xl border border-white/50 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden">
                        <!-- Header -->
                        <div class="px-5 py-4 border-b border-purple-100/50">
                            <div class="flex items-center gap-3">
                                
                                <div>
                                    <h3 class="text-lg font-bold text-gray-900">Your Stats</h3>
                                    <p class="text-xs text-gray-500">Performance overview</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Stats Grid -->
                        <div class="p-5">
                            <div class="grid grid-cols-3 gap-3">
                                <!-- Current Session -->
                                <div class="group/stat relative overflow-hidden rounded-xl p-4 border border-blue-200/50 hover:shadow-lg hover:scale-105 transition-all duration-300">
                                    <div class="absolute top-0 right-0 w-20 h-20 rounded-full -mr-10 -mt-10"></div>
                                    <div class="relative">
                                        <div class="flex items-center justify-center w-8 h-8 bg-blue-500/20 rounded-lg mb-2">
                                            <i data-lucide="clock" class="w-4 h-4 text-black"></i>
                                        </div>
                                        <div id="statSessionTime" class="text-2xl font-bold text-black mb-1">0m</div>
                                        <div class="text-xs text-black font-medium">Current Session</div>
                                    </div>
                                </div>

                                <!-- Weekly Sessions -->
                                <div class="group/stat relative overflow-hidden rounded-xl p-4 border border-indigo-200/50 hover:shadow-lg hover:scale-105 transition-all duration-300">
                                    <div class="absolute top-0 right-0 w-20 h-20 rounded-full -mr-10 -mt-10"></div>
                                    <div class="relative">
                                        <div class="flex items-center justify-center w-8 h-8 bg-indigo-500/20 rounded-lg mb-2">
                                            <i data-lucide="calendar" class="w-4 h-4 text-black"></i>
                                        </div>
                                        <div id="statWeekSessions" class="text-2xl font-bold text-black mb-1">0</div>
                                        <div class="text-xs text-black font-medium">This Week</div>
                                    </div>
                                </div>

                                <!-- Average Length -->
                                <div class="group/stat relative overflow-hidden rounded-xl p-4 border border-emerald-200/50 hover:shadow-lg hover:scale-105 transition-all duration-300">
                                    <div class="absolute top-0 right-0 w-20 h-20 rounded-full -mr-10 -mt-10"></div>
                                    <div class="relative">
                                        <div class="flex items-center justify-center w-8 h-8 bg-emerald-500/20 rounded-lg mb-2">
                                            <i data-lucide="trending-up" class="w-4 h-4 text-black"></i>
                                        </div>
                                        <div id="statAvgLength" class="text-2xl font-bold text-black mb-1">0m</div>
                                        <div class="text-xs text-black font-medium">Avg Length</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Student Information Update Modal -->
    <div id="updateInfoModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[95vh] overflow-hidden flex flex-col">
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 sm:px-6 py-4 flex-shrink-0">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                            <i data-lucide="user-check" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="text-lg sm:text-xl font-semibold">Update Your Information</h3>
                            <p class="text-orange-100 text-sm">Make the requested corrections</p>
                        </div>
                    </div>
                    <button onclick="closeUpdateInfoModal()" 
                        class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors"
                        aria-label="Close modal">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>

            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto p-4 sm:p-6">

                <!-- Correction Notice -->
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <div class="w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                            <i data-lucide="alert-triangle" class="w-3 h-3 text-orange-600"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-semibold text-orange-800 mb-2">Correction Details:</div>
                            <div id="modalCorrectionReason" class="text-sm text-orange-700 whitespace-pre-line leading-relaxed">
                                <!-- Correction reason will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Form -->
                <form id="updateInfoForm" class="space-y-6">
                    <!-- Name Fields -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="updateFirstName" class="block text-sm font-semibold text-gray-700 mb-2">
                                First Name <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="updateFirstName" required
                                class="w-full px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all duration-200 placeholder:text-gray-400 text-base">
                        </div>
                        <div>
                            <label for="updateLastName" class="block text-sm font-semibold text-gray-700 mb-2">
                                Last Name <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="updateLastName" required
                                class="w-full px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all duration-200 placeholder:text-gray-400 text-base">
                        </div>
                    </div>

                    <!-- Email -->
                    <div>
                        <label for="updateEmail" class="block text-sm font-semibold text-gray-700 mb-2">
                            Email Address <span class="text-red-500">*</span>
                        </label>
                        <input type="email" id="updateEmail" required
                            class="w-full px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all duration-200 placeholder:text-gray-400 text-base">
                        <p class="mt-1 text-xs text-gray-500">Must use official university domain (@umak.edu.ph)</p>
                    </div>

                    <!-- Student ID -->
                    <div>
                        <label for="updateStudentId" class="block text-sm font-semibold text-gray-700 mb-2">
                            Student ID <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="updateStudentId" required
                            placeholder="e.g., a12345027"
                            class="w-full px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all duration-200 placeholder:text-gray-400 text-base font-mono">
                    </div>

                    <!-- Department -->
                    <div>
                        <label for="updateDepartment" class="block text-sm font-semibold text-gray-700 mb-2">
                            College Department <span class="text-red-500">*</span>
                        </label>
                        <select id="updateDepartment" required
                            class="w-full px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all duration-200 text-base">
                            <option value="">Select your department…</option>
                            <option value="College of Liberal Arts and Sciences (CLAS)">CLAS - Liberal Arts and Sciences</option>
                            <option value="College of Business and Financial Science (CBFS)">CBFS - Business and Financial Science</option>
                            <option value="College of Computing and Information Sciences (CCIS)">CCIS - Computing and Information Sciences</option>
                            <option value="College of Continuing, Advanced and Professional Studies (CCAPS)">CCAPS - Continuing, Advanced and Professional Studies</option>
                            <option value="College of Innovative Teacher Education (CITE)">CITE - Innovative Teacher Education</option>
                            <option value="College of Construction Sciences and Engineering (CCSE)">CCSE - Construction Sciences and Engineering</option>
                            <option value="College of Engineering Technology (CET)">CET - Engineering Technology</option>
                            <option value="College of Governance and Public Policy (CGPP)">CGPP - Governance and Public Policy</option>
                            <option value="College of Tourism and Hospitality Management (CTHM)">CTHM - Tourism and Hospitality Management</option>
                            <option value="College of Human Kinetics (CHK)">CHK - Human Kinetics</option>
                            <option value="School of Law (SOL)">SOL - School of Law</option>
                        </select>
                    </div>

                    <!-- Important Notes -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                <i data-lucide="info" class="w-3 h-3 text-blue-600"></i>
                            </div>
                            <div class="text-sm text-blue-800">
                                <div class="font-semibold mb-2">Important Notes:</div>
                                <ul class="space-y-1 text-sm">
                                    <li class="flex items-start gap-2">
                                        <span class="text-blue-600 mt-1">•</span>
                                        <span>Ensure all information matches your official university records</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-blue-600 mt-1">•</span>
                                        <span>Changes will be reviewed by an administrator before activation</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-blue-600 mt-1">•</span>
                                        <span>Account access may remain limited until verification is complete</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Modal Footer -->
            <div class="flex-shrink-0 bg-gray-50 px-4 sm:px-6 py-4 border-t border-gray-200">
                <div class="flex flex-col-reverse sm:flex-row gap-3">
                    <button type="button" onclick="closeUpdateInfoModal()" 
                        class="w-full sm:w-auto px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-xl transition-all duration-200 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                        Cancel
                    </button>
                    <button type="submit" form="updateInfoForm"
                        class="w-full sm:w-auto sm:flex-1 px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-xl transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2">
                        <i data-lucide="save" class="w-4 h-4"></i>
                        Update Information
                    </button>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer-glass py-4 text-center text-sm">
        <p>University of Makati - Noise Comfort Index</p>
    </footer>

    <!-- RFID Floating Button & Expandable Panel (Persists across tab changes) -->
    <div id="rfidFloatingRoot" class="fixed bottom-6 left-6 z-[100]">
        <!-- Expandable Panel (hidden by default) -->
        <div id="rfidScanDisplay" 
             class="hidden absolute bottom-0 left-0 w-80 bg-white rounded-2xl border border-gray-200 shadow-2xl transition-all duration-300">
            
            <!-- Header Bar with Close Button -->
            <div class="border-b bg-gradient-to-r from-indigo-50 to-purple-50 rounded-t-2xl">
                <!-- Title Row with Close Button -->
                <div class="flex items-center justify-between px-4 pt-3 pb-2">
                    <div class="flex items-center gap-2">
                        <i data-lucide="radio" class="w-4 h-4 text-indigo-600"></i>
                        <span class="text-sm font-semibold text-gray-800">RFID Scan</span>
                    </div>
                    <!-- Close Button (separate from timestamp) -->
                    <button id="rfidCloseBtn"
                           class="w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-200/50 cursor-pointer transition-colors">
                        <i data-lucide="x" class="w-4 h-4 text-gray-600"></i>
                    </button>
                </div>
                <!-- Timestamp Row -->
                <div class="px-4 pb-2">
                    <span id="rfidScanTime" class="text-xs text-gray-500">—</span>
                </div>
            </div>

            <!-- Admin Mode Indicator -->
            <div id="rfidAdminMode" class="hidden px-4 py-2 bg-orange-50 border-b border-orange-200 text-xs text-orange-700 flex items-center gap-1.5">
                <i data-lucide="shield-alert" class="w-3.5 h-3.5"></i>
                <span>Admin Override Active</span>
            </div>

            <!-- Content Area -->
            <div class="p-4">
                <!-- Success State -->
                <div id="rfidSuccess" class="hidden">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="check" class="w-5 h-5 text-green-600"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="font-semibold text-gray-900 truncate" id="rfidUserName">—</div>
                            <div class="text-xs text-gray-500 truncate" id="rfidUserEmail">—</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg px-3 py-2">
                            <div class="text-gray-500 mb-1">Student ID</div>
                            <div class="font-semibold text-gray-900" id="rfidStudentId">—</div>
                        </div>
                        <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg px-3 py-2">
                            <div class="text-gray-500 mb-1">Seat</div>
                            <div class="font-semibold text-gray-900" id="rfidSeatNumber">—</div>
                        </div>
                    </div>
                </div>

                <!-- Inactive State -->
                <div id="rfidInactive" class="hidden">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-600"></i>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-900 mb-1">Card Inactive</div>
                            <p class="text-xs text-gray-600 leading-relaxed">This card has been deactivated. Contact an administrator.</p>
                        </div>
                    </div>
                </div>

                <!-- Unregistered State -->
                <div id="rfidUnregistered" class="hidden">
                    <div class="flex items-start gap-3 mb-2.5">
                        <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="x" class="w-5 h-5 text-red-600"></i>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-900 mb-1">Unknown Card</div>
                            <p class="text-xs text-gray-600">This card is not registered.</p>
                        </div>
                    </div>
                    <div class="bg-gray-900 text-gray-100 rounded-lg px-3 py-2 font-mono text-xs break-all">
                        <span id="rfidUnknownUid">—</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="scripts/dashboard.js"></script>
        <script>
            // Lazy load and fade in the library background, just like login.html
            document.addEventListener('DOMContentLoaded', function () {
                var bg = document.querySelector('.library-background');
                if (bg && bg.dataset.bg) {
                    var img = new window.Image();
                    img.onload = function () {
                        bg.style.backgroundImage = 'url(' + bg.dataset.bg + ')';
                        bg.classList.add('loaded');
                    };
                    img.src = bg.dataset.bg;
                }
            });
        </script>
</body>

</html>
